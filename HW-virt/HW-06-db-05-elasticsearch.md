# Домашнее задание к занятию "6.5. Elasticsearch"

## Задача 1
В этом задании вы потренируетесь в:

+ установке elasticsearch
+ первоначальном конфигурировании elastcisearch
+ запуске elasticsearch в docker
Используя докер образ elasticsearch:7 как базовый:

+ составьте Dockerfile-манифест для elasticsearch
+ соберите docker-образ и сделайте push в ваш docker.io репозиторий
+ запустите контейнер из получившегося образа и выполните запрос пути / c хост-машины

Требования к elasticsearch.yml:

+ данные path должны сохраняться в /var/lib
+ имя ноды должно быть netology_test

В ответе приведите:

+ текст Dockerfile манифеста
+ ссылку на образ в репозитории dockerhub
+ ответ elasticsearch на запрос пути / в json виде

Подсказки:

+ при сетевых проблемах внимательно изучите кластерные и сетевые настройки в elasticsearch.yml
+ при некоторых проблемах вам поможет docker директива ulimit
+ elasticsearch в логах обычно описывает проблему и пути ее решения
+ обратите внимание на настройки безопасности такие как xpack.security.enabled
+ если докер образ не запускается и падает с ошибкой 137 в этом случае может помочь настройка -e ES_HEAP_SIZE
+ при настройке path возможно потребуется настройка прав доступа на директорию
Далее мы будем работать с данным экземпляром elasticsearch.


## Задача 2
В этом задании вы научитесь:

+ создавать и удалять индексы
+ изучать состояние кластера
+ обосновывать причину деградации доступности данных

Ознакомтесь с документацией и добавьте в elasticsearch 3 индекса, в соответствии со таблицей:

Имя | Количество реплик	| Количество шард
|---|---|
ind-1	| 0 |	1
ind-2 |	1 |	2
ind-3 |	2	| 4
Получите список индексов и их статусов, используя API и приведите в ответе на задание.

Получите состояние кластера elasticsearch, используя API.

Как вы думаете, почему часть индексов и кластер находится в состоянии yellow?

Удалите все индексы.

Важно

При проектировании кластера elasticsearch нужно корректно рассчитывать количество реплик и шард, иначе возможна потеря данных индексов, вплоть до полной, при деградации системы.
